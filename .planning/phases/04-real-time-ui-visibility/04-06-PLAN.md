---
phase: 04-real-time-ui-visibility
plan: 06
type: execute
wave: 2
depends_on: []
files_modified:
  - apps/web/components/session/status-indicator.tsx
  - apps/web/components/chat/chat-interface.tsx
autonomous: true

must_haves:
  truths:
    - "User sees real-time status indicators showing agent's current state (planning, executing, stuck)"
    - "Status indicators update in real-time via WebSocket"
    - "Status indicators have animated states matching Ramp design"
  artifacts:
    - path: "apps/web/components/session/status-indicator.tsx"
      provides: "Enhanced status indicator with real-time updates"
      contains: "real-time WebSocket updates"
  key_links:
    - from: "apps/web/components/chat/chat-interface.tsx"
      to: "apps/web/components/session/status-indicator.tsx"
      via: "onStatusChange callback"
      pattern: "onStatusChange"
---

<objective>
Enhance status indicator component to show real-time agent state updates via WebSocket with animated indicators matching Ramp design.

Purpose: Provide clear, real-time visibility into agent's current state (planning, executing, stuck, idle) so users know what the agent is doing at all times.
Output: Enhanced status indicator with real-time WebSocket updates and animated states
</objective>

<execution_context>
@/Users/dylansteck/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/dylansteck/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-real-time-ui-visibility/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance status-indicator with real-time updates and animations</name>
  <files>apps/web/components/session/status-indicator.tsx</files>
  <action>
Enhance existing status-indicator.tsx to show real-time agent state with animated indicators.

Enhancements:
- Support all agent states: 'idle', 'planning', 'coding', 'testing', 'executing', 'stuck', 'error'
- Animated indicators for active states (planning, coding, executing) - pulse or spinner
- Color coding: idle (gray), planning (blue), executing (green), stuck (yellow), error (red)
- Display current tool name when available (e.g., "Planning...", "Writing file.ts")
- Smooth transitions between states
- Clean styling matching Ramp design

Status updates come from WebSocket events: { type: 'agent-status', status: '...', details: '...' }

Preserve existing status-indicator functionality. Enhance with animations and real-time updates.

Reference RESEARCH.md Pattern 3 for implementation details. Use Tailwind animations (animate-pulse, etc.).
</action>
  <verify>
status-indicator.tsx supports all agent states. Animated indicators work for active states. Color coding correct. Current tool name displays when available. Smooth transitions between states.
</verify>
  <done>
Status indicator enhanced with real-time updates and animations. All agent states supported with proper visual feedback.
</done>
</task>

<task type="auto">
  <name>Task 2: Ensure chat-interface passes status updates correctly</name>
  <files>apps/web/components/chat/chat-interface.tsx</files>
  <action>
Verify and enhance chat-interface.tsx to properly pass status updates to status indicator.

Ensure:
- WebSocket 'agent-status' events call onStatusChange callback correctly
- SSE 'tool-call' events map to status correctly (planning, coding, testing)
- Status updates include current tool name/details when available
- Status changes trigger onStatusChange with correct parameters

Review existing WebSocket and SSE handling. Ensure status updates flow correctly to status indicator component.

Reference existing chat-interface.tsx WebSocket handling and RESEARCH.md Pattern 3.
</action>
  <verify>
chat-interface.tsx passes status updates correctly. WebSocket agent-status events trigger onStatusChange. SSE tool-call events map to status. Status includes tool details when available.
</verify>
  <done>
Chat interface properly passes status updates. Status indicator receives real-time updates from WebSocket and SSE events.
</done>
</task>

</tasks>

<verification>
- Status indicator shows all agent states correctly
- Real-time updates work via WebSocket
- Animated indicators display for active states
- Color coding matches state (idle, planning, executing, stuck, error)
- Current tool name displays when available
- Smooth transitions between states
</verification>

<success_criteria>
User sees real-time status indicators showing agent's current state. Status updates in real-time via WebSocket. Animated indicators provide clear visual feedback. Status display matches Ramp design.
</success_criteria>

<output>
After completion, create `.planning/phases/04-real-time-ui-visibility/04-06-SUMMARY.md`
</output>
